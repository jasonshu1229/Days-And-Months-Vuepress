---
title: 核心语法JSX
date: 2023-02-05 20:18:57
permalink: /pages/213243/
---

## JSX 是什么

JSX 简单来说是下面这样的代码：

```jsx
const element = <h1>Hello, world!</h1>;
```

这段标签语法既不是字符串也不是 HTML，看似 JavaScript 和 HTML的语法融合，它被称为 JSX，是一个 JavaScript 的语法扩展。React 团队建议配合使用 JSX，它可以很好的描述 UI 应该呈现出它应有的交互本质形式。，它具有 JavaScript 的全部功能。

JSX 可以生成**React元素**，后面章节介绍。

### JSX的书写规范

在 React 中通常使用 JSX 语法，它有以下几条规范：

- JSX的顶层只能有一个根元素，通常需要在最外层包裹一个div原生标签（或者使用后面学习的Fragment）；
- 为了阅读方便，JSX结构通常会包裹一个小括号（），将整个 JSX 当做一个整体，实现换行，不加小括号则不能实现换行；
- JSX 中的标签可以是**单标签**，也可以是**双标签**；
  - 注意：如果是单标签，必须以“/>”结尾；
- JSX 标签里能够包含很多子元素；

```jsx
const element = (
  <div>
    <h1>Hello!</h1>
    <img src="xxx" />
    <div>{message}</div>
  </div>
)
```

在 React 里的用法：

```jsx
class App extends React.Component {
  constructor() {
    super();
    this.state = {
      message: 'Hello World'
    }
    
  }
  
  render() {
    const element = (
      <div>
        <h1>Hello!</h1>
        <div>{this.state.message}</div>
      </div>
    )
    return element
  }
}
```

也可以把 element 里面的内容直接放在 return 后面：

```jsx
render() {
  return (
    <div>
      <h1>Hello!</h1>
      <div>{this.state.message}</div>
    </div>
  )
}
```

### JSX 中插入注释

注释方便其他开发人员的阅读，那么在 JSX 中的注释编写方式如下：

```jsx
render() {
  // state的解构
  const { message } = this.state;

  return (
    <div>
      {/* JSX的注释写法 */}
      <h2>{message}</h2>
    </div>
  )
}
```

### JSX 中插入内容类型

JSX 可以插入内容的类型分为两大类，一类是插入变量类型，另一类是表达式类型。

#### JSX 中可以嵌入变量作为子元素

- 情况一：当变量是`Number`、`String`、`Array`类型时，可以直接显示；
- 情况二：当变量是`null`、`undefined`、`Boolean`时，内容为空；
  - 如果希望可以显示null、undefined、Boolean，则需要转成字符串；
  - 转换的方式有很多，比如 toString 方法，空字符串拼接，String(变量)等方式；
- 情况三：`Object对象类型`不能作为子元素（not valid as a React child）；

举例如下：

```jsx
constructor() {
  super();
  this.state = {
    counter: 100,
    message: 'Hello World',
    names: ["abc", "cba", "nba"],
    
    aaa: undefined,
    bbb: null,
    ccc: true,
    
    friend: { name: 'kobe' },
  }
}

render() {
  // 插入的内容是标识符类型
  const { message, names, counter } = this.state;
  const { aaa, bbb, ccc} = this.state;
  const { friend } = this.state;
  
  return (
    <div>
      { /* 1. Number/String/Array 可以直接显示 */ }
      <h2>{counter}</h2>
      <h2>{message}</h2>
      <h2>{names}</h2>

      { /* 2. undefined/null/Boolean */ }
      <h2>{String(aaa)}</h2>
      <h2>{bbb + ""}</h2>
      <h2>{ccc.toString()}</h2>

      { /* 3. Object类型不能作为子元素进行显示 */ }
      <h2>{friend.name}</h2>
      <h2>{Object.values(friend)[0]}</h2>
    </div>
  )
}
```

#### JSX 中可以嵌入表达式

嵌入的表达式的类型有三种：运算表达式、三元运算符，执行一个函数。

举例如下：

```jsx
constructor() {
  super();
  this.state = {
    firstName: 'kobe',
    lastName: 'bryant',
    
    age: 20,
    
    movies: ["流浪地球", "满江红", "狂飙"]
  }
}

render() {
  // 对内容进行运算后显示
  const { firstName, lastName } = this.state;
  const fullName = firstName + " " + lastName;
  const { age } = this.state;
  const ageText = age >= 18 ? "成年人" : "未成年人";
  const liEls = this.state.movies.map(movie => <li>{movie}</li>)
  
  return (
    <div>
      { /* 4. 插入运算表达式 */ }
      <h2>{10 + 20}</h2>
      <h2>{firstName + " " + lastName}</h2>
      <h2>{fullName}</h2>

      { /* 5. 插入三元运算符 */ }
      <h2>{ageText}</h2>
      <h2>{age >= 18 ? "成年人" : "未成年人"}</h2>

      { /* 6. 调用函数获取结果 */ }
      <ul>{liEls}</ul>
      <ul>{this.state.movies.map(movie => <li>{movie}</li>)}</ul>
      <ul>{this.getMovieEls()}</ul>
    </div>
  )
}
```

### JSX 中绑定属性

在 JSX 中也可以绑定元素的属性，比如元素都会有 title 属性，img 元素会有 src 属性，a 元素会有 href 属性， 元素可能需要绑定 class，原生元素使用内联样式 style 等。

基本属性的绑定：

```jsx
constructor() {
  super();
  this.state = {
    title: "哈哈哈",
    imgURL: "xxx",
    href: "https://www.baidu.com",
  }
}

render() {
  const { title, imgURL, href } = this.state;
  
  return (
    <div>
      { /* 1. 基本属性绑定 */}
      <h2 title={title}>我是h2元素</h2>
      <img src={imgURL} />
      <a href={href}>百度一下</a>
    </div>
  )
}
```

动态绑定class属性有三种写法，在这里会介绍两种，第三种是应用在脚手架中，后面会详细介绍。

所谓的动态绑定就是根据 state 的变化，动态的增删 class 类。

```jsx
constructor() {
  super();
  this.state = {
    isActive: true,
  }
}

render() {
  const { isActive } = this.state;
  
  // 1. class绑定的写法一：模板字符串拼接
  const className = `abc cba ${isActive ? 'active' : ''}`;
  // 2. class绑定的写法二：将所有的class放到数组中
  const classList = ["bac", "cba"];
  if (isActive) classList.push("active");
  // 3. class绑定的写法三：第三方库 classnames -> npm install classnames
  
  return (
    <div>
      { /* 2. 绑定class属性：最好使用className */}
      <h2 className={className}>动态绑定class</h2>
      <h2 className={classList.join(" ")}></h2>
    </div>
  )
}
```

在平常开发中，有时还需要绑定 style 属性，注意：绑定的 style 类型是对象类型。

```jsx
constructor() {
  super();
  this.state = {
    objStyle: {color: "red", fontSize: "30px"}
  }
}

render() {
  const { objStyle } = this.state;
  
  return (
    <div>
      { /* 3. 绑定style属性：绑定对象类型 */}
      <h2 style={{color: "red", fontSize: "30px"}}>绑定对象类型方式一</h2>
      <h2 style={objStyle}>绑定对象类型方式二</h2>
    </div>
  )
}
```

### JSX 的事件绑定

React 中事件绑定和原生标签的事件绑定有两点不同。

React 事件的**命名采用小驼峰式，而不是纯小写**，另外还需要**通过{}传入一个事件处理函数**，这个函数会在事件发生时**被执行**。

前面提到了，像下面这样绑定事件，出线 this 指向丢失问题：

```jsx
btnClick() {
  console.log(this); // undefined
}

render() {
  return (
    <button onClick={this.btnClick}>btn</button>
  )
}

```